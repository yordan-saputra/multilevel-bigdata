\section{Introduction}

    \subsection{Multilevel Models}
    \begin{frame}
        \frametitle{\insertsection\ $-$ \insertsubsection}
        \begin{columns}[c] 
            \begin{column}{0.48\textwidth}
                \textbf{What are multilevel models?}
                \begin{itemize}
                    \item Hierarchical Structure
                    \item Residual Components
                    \item Variance Partitioning
                \end{itemize}
            \end{column}
            \begin{column}{0.5\textwidth}
                \textbf{Why use multilevel models?}
                \begin{itemize}
                    \item Correct Inferences
                    \item Group Effects Estimation
                    \item Simultaneous Estimation
                    \item Generalization Beyond Sample \footnotemark
                \end{itemize}
            \end{column}
        \end{columns} 
        \footcitetext{bristolCMM}

        \vspace{0.4cm}

        \textbf{Statistical Model}
        \[
            \begin{aligned}
                y_n &\sim \mathcal{N}\left(\mu_n, \sigma\right) \\
                \mu_n &= b_0 + \sum_{p=1}^P b_p x_{pn} + \tilde{b}_{0j[n]} + \sum_{p=1}^P \tilde{b}_{pj[n]} x_{pn}
            \end{aligned}
        \]
    \end{frame}

    \note{
        \tiny
        \textbf{What are multilevel models?}
        \begin{itemize}
            \item Hierarchical Structure: Observational data often feature individuals nested within higher-level groups, such as schools, workplaces, or geographical areas.
            \item Residual Components: Multilevel models account for these hierarchies by incorporating residual components at every level of the data structure.
            \item Variance Partitioning: These models divide residual variance into between-group and within-group components to capture unobserved factors influencing outcomes.
        \end{itemize}
        \textbf{Why use multilevel models?}
        \begin{itemize}
            \item Correct Inferences: Traditional methods assume independent observations, which are often false. Additionally, ignoring hierarchical structures can lead to underestimated standard errors and overstated statistical significance.
            \item Group Effects Estimation: Directly quantify between-group variation and identify outlying groups.
            \item Simultaneous Estimation: Unlike fixed effects models, the separation of observed and unobserved group characteristics is possible, allowing for simultaneous estimation of group-level and individual-level effects.
            \item Generalization Beyond Sample: Unlike fixed effects models which only describe sampled groups, multilevel models treat groups as random samples from a population, enabling generalizations to unobserved groups.
        \end{itemize}
    }
    \note{
        \small
        \textbf{Statistical Model}
        \[
            \begin{aligned}
                y_n &\sim \mathcal{N}\left(\mu_n, \sigma\right) \\
                \mu_n &= b_0 + b_1 x_{1n} + \ldots + b_p x_{pn} + \tilde{b}_{0j[n]} + \tilde{b}_{1j[n]} x_{1n} + \ldots + \tilde{b}_{pj[n]} x_{pn}
            \end{aligned}
        \]
        where:
        \begin{itemize}
            \item $y_n$: dependent variable for observation $n$
            \item $x_{pn}$: predictor variable $p$ for observation $n$
            \item $b_p$: overall slope (or intercept for $p=0$) for predictor $p$ across all groups
            \item $\tilde{b}_{pj[n]}$: random effect of predictor $p$ for group $j$ that observation $n$ belongs to
            \item $\sigma$: residual standard deviation (assumed constant across observations)
        \end{itemize}
    }

    \subsection{Issues with Large Datasets}
    \begin{frame}
        \frametitle{\insertsection\ $-$ \insertsubsection}
        Hierarchical data ($N$ groups $\times$ $n$ individuals) expands dramatically, potentially reaching gigabytes in size. Two main issues with large datasets:
        \begin{itemize}
            \item \textbf{Large number of groups}: Computational bottleneck from numerical integration over random effects for each group at every optimization step, leading to high computational costs
            \item \textbf{Large group sizes}: High-dimensional multivariate distributions create numerical issues with large covariance matrix inversion, even in linear models \footcites{clark2019}{speelman2018}
        \end{itemize}
    \end{frame}

    \note{
        Issues with Large Datasets
        \begin{itemize}
            \item it's even worse when we add another level to the hierarchy, e.g. students nested within classes nested within schools, which is common in educational research.
            \item the fitting of mixed models implies integrating random effects for which approximations are needed. Because this needs to be done for each cluster in the data set separately, and at each step of the optimization process, this can become extremely time consuming in cases where the number N of clusters is (very) large. Alternatively, large numbers n of observations per cluster lead to high-dimensional multivariate distributions for the measurements per cluster. This creates numerical problems, even in the linear model, due to numerical inversion of large covariance structures
        \end{itemize}
    }